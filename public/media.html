<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Media Search</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  background: #000;
  color: white;
  font-family: Arial, sans-serif;
}

/* HEADER */
header {
  padding: 15px;
  background: #090009;
  display: flex;
  gap: 10px;
}

input {
  flex: 1;
  padding: 12px;
  border-radius: 8px;
  border: none;
  font-size: 16px;
}

button {
  padding: 12px 20px;
  border-radius: 8px;
  border: none;
  background: #7f00ff;
  color: white;
  cursor: pointer;
}

/* PLAYER */
#player iframe {
  width: 100%;
  height: 60vh;
  border: none;
  margin-top: 10px;
}

/* RESULTS */
#results {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px,1fr));
  gap: 15px;
  padding: 15px;
}

.video {
  background: #12001f;
  border-radius: 10px;
  overflow: hidden;
  cursor: pointer;
  transition: transform 0.15s ease;
}

.video:hover {
  transform: scale(1.04);
}

.video img {
  width: 100%;
}

.video p {
  font-size: 14px;
  padding: 8px;
  margin: 0;
}
</style>
</head>

<body>

<header>
  <input id="q" placeholder="Search videosâ€¦" />
  <button onclick="search()">Search</button>
</header>

<div id="player"></div>
<div id="results"></div>

<script>
/**
 * This recreates the behavior of the media page you linked.
 *
 * We use Piped (privacy YouTube frontend) to:
 *  - search videos
 *  - play selected videos
 * and avoid direct scraping of youtube.com.
 *
 * References:
 * - Piped public instances list (works as privacy frontend) :contentReference[oaicite:0]{index=0}
 */

const PIPED_API = "https://pipedapi.kavin.rocks"; // A reliable Piped instance
const CORS_PROXY = "https://api.allorigins.win/raw?url=";

/**
 * Search for videos
 */
async function search() {
  const query = document.getElementById("q").value.trim();
  if (!query) return;

  document.getElementById("results").innerHTML = "<p>Searching...</p>";
  document.getElementById("player").innerHTML = "";

  try {
    const searchUrl = `${PIPED_API}/search?query=${encodeURIComponent(query)}&type=video`;
    const resp = await fetch(CORS_PROXY + encodeURIComponent(searchUrl));
    const data = await resp.json();

    const resultsDiv = document.getElementById("results");
    resultsDiv.innerHTML = "";

    // Display up to 30 videos
    (data.items || []).slice(0, 30).forEach(video => {
      const vidId = video.url?.split("v=")?.[1] || video.id;

      const card = document.createElement("div");
      card.className = "video";
      card.innerHTML = `
        <img src="${video.thumbnail}" alt="${video.title}">
        <p>${video.title}</p>
      `;
      card.onclick = () => playVideo(vidId);

      resultsDiv.appendChild(card);
    });

  } catch (err) {
    console.error(err);
    document.getElementById("results").innerHTML = "<p>Search failed.</p>";
  }
}

/**
 * Play one of the results
 */
function playVideo(videoId) {
  document.getElementById("player").innerHTML = `
    <iframe
      src="https://piped.video/embed/${videoId}"
      allowfullscreen
      referrerpolicy="no-referrer"
    ></iframe>
  `;
}
</script>

</body>
</html>
